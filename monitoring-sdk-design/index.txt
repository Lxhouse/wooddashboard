3:I[4641,[],""]
5:I[2063,[],""]
6:I[3436,["645","static/chunks/645-cf0c536310c9bd45.js","64","static/chunks/app/%5Bslug%5D/layout-447ff52c5afa5bc6.js"],"default"]
7:I[1763,["645","static/chunks/645-cf0c536310c9bd45.js","792","static/chunks/792-a990f77874873bec.js","185","static/chunks/app/layout-1a2c4bccb07c8fb1.js"],"default"]
8:I[966,["645","static/chunks/645-cf0c536310c9bd45.js","42","static/chunks/app/%5Bslug%5D/page-0b8af52342fb8394.js"],"default"]
4:["slug","monitoring-sdk-design","d"]
0:["8T3wn1F1pRLVmuuuLhNTA",[[["",{"children":[["slug","monitoring-sdk-design","d"],{"children":["__PAGE__?{\"slug\":\"monitoring-sdk-design\"}",{}]}]},"$undefined","$undefined",true],["",{"children":[["slug","monitoring-sdk-design","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},[[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],["$","footer",null,{"className":"mt-12","children":["$","$L6",null,{}]}]],null],null]},[["$","$L7",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","article",null,{"className":"markdown","children":[["$","h1",null,{"className":"__className_620977 text-[40px] font-black leading-[44px] text-[--title]","children":"Not found"}],["$","div",null,{"className":"markdown mt-10","children":[["$","p",null,{"children":"这篇文章没有被找到 ?(没有创建 ?)"}],["$","p",null,{"children":["如果你认为是网站的问题,可以点击这里告诉我"," ",["$","$L8",null,{"href":"https://github.com/Lxhouse/wooddashboard/issues","children":"点击这里"}]]}],["$","p",null,{"children":["如果是之前的文章,你却找不到了,可以来这里寻找试试"," ",["$","$L8",null,{"href":"https://github.com/Lxhouse/wooddashboard/tree/main/public","children":"文章档案馆"}]]}],["$","p",null,{"children":"希望你可以找到你需要的那篇文章"}]]}]]}],"notFoundStyles":[],"styles":null}],"params":{}}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/wooddashboard/_next/static/css/f4c9dd7a6d7a870e.css","precedence":"next","crossOrigin":"$undefined"}]],"$L9"]]]]
2:["$","div",null,{"className":"mx-auto max-w-[90rem] px-4 sm:px-6 lg:px-8","children":["$","div",null,{"className":"relative lg:flex lg:gap-8","children":[["$","article",null,{"className":"prose prose-lg dark:prose-invert lg:min-w-[720px] lg:max-w-[720px] xl:min-w-[800px] xl:max-w-[800px]","children":[["$","h1",null,{"className":"__className_620977 text-[40px] font-black leading-[44px] text-[--title] mb-4","children":"我是如何设计前端监控 SDK 的"}],["$","p",null,{"className":"text-sm text-gray-700 dark:text-gray-300 mb-8","children":"2024/10/11"}],["$","div",null,{"className":"markdown","children":["$La",["$","hr",null,{"className":"my-8"}],["$","p",null,{"className":"flex gap-8","children":[["$","$L8",null,{"href":"www.baidu.com","children":"Discuss on"}],["$","$L8",null,{"href":"www.baidu.com","children":"Edit on GitHub"}]]}]]}]]}],["$","nav",null,{"className":"hidden lg:block lg:min-w-[240px] lg:max-w-[240px] xl:min-w-[280px] xl:max-w-[280px]","children":["$","div",null,{"className":"sticky top-8","children":["$","nav",null,{"className":"text-sm","aria-label":"Table of contents","children":[["$","p",null,{"className":"mb-4 text-base font-medium text-gray-900 dark:text-gray-100","children":"目录"}],["$","ul",null,{"className":"space-y-1","children":[["$","li","-",{"children":["$","a",null,{"href":"#-","className":"block rounded-sm transition-all duration-200\n                  pl-2","children":"核心架构设计"}]}],["$","li","1-thelogger-",{"children":["$","a",null,{"href":"#1-thelogger-","className":"block rounded-sm transition-all duration-200\n                  pl-6","children":"1. TheLogger 核心类"}]}],["$","li","2-",{"children":["$","a",null,{"href":"#2-","className":"block rounded-sm transition-all duration-200\n                  pl-6","children":"2. 插件系统"}]}],["$","li","3-",{"children":["$","a",null,{"href":"#3-","className":"block rounded-sm transition-all duration-200\n                  pl-6","children":"3. 服务层设计"}]}],["$","li","4-",{"children":["$","a",null,{"href":"#4-","className":"block rounded-sm transition-all duration-200\n                  pl-6","children":"4. 数据存储策略"}]}],["$","li","5-",{"children":["$","a",null,{"href":"#5-","className":"block rounded-sm transition-all duration-200\n                  pl-6","children":"5. 上报策略"}]}],["$","li","-",{"children":["$","a",null,{"href":"#-","className":"block rounded-sm transition-all duration-200\n                  pl-2","children":"实践经验"}]}],["$","li","-",{"children":["$","a",null,{"href":"#-","className":"block rounded-sm transition-all duration-200\n                  pl-2","children":"未来规划"}]}],["$","li","-",{"children":["$","a",null,{"href":"#-","className":"block rounded-sm transition-all duration-200\n                  pl-2","children":"总结"}]}]]}]]}]}]}]]}]}]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"我是如何设计前端监控 SDK 的 — wooddashboard"}],["$","meta","3",{"name":"description","content":"分享我在设计前端监控 SDK 时的架构思考，包括插件系统、生命周期管理、数据存储等核心设计"}],["$","link","4",{"rel":"icon","href":"/wooddashboard/icon.png?7c5860f098ab6c65","type":"image/png","sizes":"400x400"}],["$","meta","5",{"name":"next-size-adjust"}]]
1:null
a:[["$","h1",null,{"id":"-sdk-","children":["$","a",null,{"href":"#-sdk-","className":"anchor","children":"我是如何设计前端监控 SDK 的"}]}],"\n",["$","p",null,{"children":"作为一名前端监控领域的开发者，我一直在思考如何设计一个既灵活又高效的监控 SDK。经过多次迭代和实践，我最终确定了一个以插件系统和生命周期为核心的架构设计。让我来分享一下这个设计的核心思路。"}],"\n",["$","h2",null,{"id":"-","children":["$","a",null,{"href":"#-","className":"anchor","children":"核心架构设计"}]}],"\n",["$","h3",null,{"id":"1-thelogger-","children":["$","a",null,{"href":"#1-thelogger-","className":"anchor","children":"1. TheLogger 核心类"}]}],"\n",["$","p",null,{"children":"在设计之初，我就决定要有一个强大的核心类作为整个 SDK 的基础。我将其命名为 TheLogger，它负责协调整个监控系统的运行。"}],"\n",["$","div",null,{"data-rehype-pretty-code-fragment":"","children":["$","pre",null,{"className":"Overnight","style":{"backgroundColor":"var(--code-bg)"},"tabIndex":"0","data-language":"ts","data-theme":"default","children":["$","code",null,{"data-language":"ts","data-theme":"default","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"class"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"TheLogger"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" plugins"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Plugin"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"[]"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"[];"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"constructor"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LoggerConfig"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"lifecycle "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"new"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"Lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"store "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"new"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"Store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"storage"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 生命周期方法"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"init"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"emit"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"init"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"initPlugins"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"start"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"emit"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"start"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"startPlugins"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"stop"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"emit"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"stop"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"stopPlugins"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"destroy"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"lifecycle"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"emit"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"destroy"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"destroyPlugins"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"2-","children":["$","a",null,{"href":"#2-","className":"anchor","children":"2. 插件系统"}]}],"\n",["$","p",null,{"children":"插件系统是我最自豪的设计之一。它让 SDK 具备了无限的扩展可能："}],"\n",["$","div",null,{"data-rehype-pretty-code-fragment":"","children":["$","pre",null,{"className":"Overnight","style":{"backgroundColor":"var(--code-bg)"},"tabIndex":"0","data-language":"ts","data-theme":"default","children":["$","code",null,{"data-language":"ts","data-theme":"default","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"interface"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" Plugin "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"string"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"apply"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"logger"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"TheLogger"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"):"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"init"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"?():"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"start"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"?():"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"stop"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"?():"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"destroy"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"?():"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"class"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"ClickTrackingPlugin"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"implements"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" Plugin "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  name "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"click-tracking"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"handler"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"e"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"MouseEvent"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"=>"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"apply"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"logger"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"TheLogger"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"handler"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"e"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"=>"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      logger"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"track"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"click"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        x"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" e"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"clientX"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        y"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" e"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"clientY"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        target"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" e"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"target"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"});"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"};"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"start"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    document"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"addEventListener"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"click"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"handler"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"stop"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    document"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"removeEventListener"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"click"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"handler"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"3-","children":["$","a",null,{"href":"#3-","className":"anchor","children":"3. 服务层设计"}]}],"\n",["$","p",null,{"children":"我特意将服务层设计成可扩展的形式："}],"\n",["$","div",null,{"data-rehype-pretty-code-fragment":"","children":["$","pre",null,{"className":"Overnight","style":{"backgroundColor":"var(--code-bg)"},"tabIndex":"0","data-language":"ts","data-theme":"default","children":["$","code",null,{"data-language":"ts","data-theme":"default","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"interface"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" LoggerService "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"serve"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"():"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"send"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LogData"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"):"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Promise"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"<"}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"void"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":">"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"class"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"DefaultService"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"implements"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" LoggerService "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" worker"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Worker"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"constructor"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"worker "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"new"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"Worker"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"logger-worker.js"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"serve"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 初始化服务"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"initWorker"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"initStorage"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"send"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LogData"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 通过 Worker 异步处理数据"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"worker"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"postMessage"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      type"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"process"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"});"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"4-","children":["$","a",null,{"href":"#4-","className":"anchor","children":"4. 数据存储策略"}]}],"\n",["$","p",null,{"children":"在存储方面，我选择了 IndexedDB 作为主要存储方案："}],"\n",["$","div",null,{"data-rehype-pretty-code-fragment":"","children":["$","pre",null,{"className":"Overnight","style":{"backgroundColor":"var(--code-bg)"},"tabIndex":"0","data-language":"ts","data-theme":"default","children":["$","code",null,{"data-language":"ts","data-theme":"default","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"class"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Store"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" db"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"IDBDatabase"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"init"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"db "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"openDatabase"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"createStores"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"createStores"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 创建三个存储空间"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"const"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":" "}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"stores"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"["}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"archive"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" keyPath"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"id"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" autoIncrement"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#F87086"},"children":"true"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"moment"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" keyPath"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"id"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" autoIncrement"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#F87086"},"children":"true"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" keyPath"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#ECC48D"},"children":"key"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"'"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"},"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"];"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"for"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"const"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":" "}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"store"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"of"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" stores"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"if"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"(!"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"db"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"objectStoreNames"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"contains"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"))"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"        "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"db"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"createObjectStore"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"name"}],["$","span",null,{"style":{"color":"#C792EA"},"children":","}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" store"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"config"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"5-","children":["$","a",null,{"href":"#5-","className":"anchor","children":"5. 上报策略"}]}],"\n",["$","p",null,{"children":"我设计了多种上报策略来平衡实时性和性能："}],"\n",["$","div",null,{"data-rehype-pretty-code-fragment":"","children":["$","pre",null,{"className":"Overnight","style":{"backgroundColor":"var(--code-bg)"},"tabIndex":"0","data-language":"ts","data-theme":"default","children":["$","code",null,{"data-language":"ts","data-theme":"default","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFA7C4"},"children":"class"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"ReportStrategy"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" batchSize "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#F78C6C"},"children":"100"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" batchTimeout "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#F78C6C"},"children":"5000"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" queue"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LogData"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"[]"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"[];"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" timer"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" NodeJS"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"Timeout"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"|"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"null"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#F87086"},"children":"null"}],["$","span",null,{"style":{"color":"#C792EA"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"constructor"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" service"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LoggerService"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"async"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"report"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":":"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFCB8B"},"children":"LogData"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"if"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"isUrgent"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"))"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 立即上报"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"await"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"service"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"send"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"else"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#637777"},"children":"// 批量上报"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"queue"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"push"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"data"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"scheduleBatchReport"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"private"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"scheduleBatchReport"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"if"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"("}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"queue"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"length"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":">="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"batchSize"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"flushQueue"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"();"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"else"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"if"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"(!"}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"timer"}],["$","span",null,{"style":{"color":"#C792EA"},"children":")"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"{"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"      "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"timer "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"="}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"setTimeout"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"(()"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"=>"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#8EACE3"},"children":"flushQueue"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"(),"}],["$","span",null,{"style":{"color":"#CED2D6"},"children":" "}],["$","span",null,{"style":{"color":"#FFA7C4"},"children":"this"}],["$","span",null,{"style":{"color":"#C792EA"},"children":"."}],["$","span",null,{"style":{"color":"#CED2D6"},"children":"batchTimeout"}],["$","span",null,{"style":{"color":"#C792EA"},"children":");"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"    "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#CED2D6"},"children":"  "}],["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C792EA"},"children":"}"}]}]]}]}]}],"\n",["$","h2",null,{"id":"-","children":["$","a",null,{"href":"#-","className":"anchor","children":"实践经验"}]}],"\n",["$","p",null,{"children":"在实际应用中，我发现这个架构带来了很多好处："}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["$","strong",null,{"children":"灵活性"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"插件系统让功能扩展变得简单"}],"\n",["$","li",null,{"children":"服务层抽象使得存储和上报方式可以轻松替换"}],"\n",["$","li",null,{"children":"生命周期钩子提供了充分的定制空间"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["$","strong",null,{"children":"性能"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"WebWorker 处理避免阻塞主线程"}],"\n",["$","li",null,{"children":"批量上报减少网络请求"}],"\n",["$","li",null,{"children":"IndexedDB 提供高效的本地存储"}],"\n"]}],"\n"]}],"\n",["$","li",null,{"children":["\n",["$","p",null,{"children":["$","strong",null,{"children":"可维护性"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"清晰的模块划分"}],"\n",["$","li",null,{"children":"标准化的插件接口"}],"\n",["$","li",null,{"children":"完善的类型定义"}],"\n"]}],"\n"]}],"\n"]}],"\n",["$","h2",null,{"id":"-","children":["$","a",null,{"href":"#-","className":"anchor","children":"未来规划"}]}],"\n",["$","p",null,{"children":"这个架构还在不断进化，我计划添加："}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"更智能的采样策略"}],"\n",["$","li",null,{"children":"更强大的数据压缩算法"}],"\n",["$","li",null,{"children":"更完善的错误追踪能力"}],"\n",["$","li",null,{"children":"更多的内置插件"}],"\n"]}],"\n",["$","h2",null,{"id":"-","children":["$","a",null,{"href":"#-","className":"anchor","children":"总结"}]}],"\n",["$","p",null,{"children":"设计一个好的监控 SDK 不仅需要考虑功能的完整性，更要思考如何让它既易用又高效。通过插件系统和生命周期管理，我实现了一个灵活可扩展的架构，它能够适应各种监控需求，同时保持了很好的性能和可维护性。"}],"\n",["$","p",null,{"children":"这个设计还在不断完善中，但核心的架构思想已经经受住了实践的检验。希望这些经验能对其他开发者有所帮助。"}]]
